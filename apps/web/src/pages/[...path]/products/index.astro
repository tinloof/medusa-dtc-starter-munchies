---
import ProductsGrid from "@/components/plp/products-grid.astro";
import { Heading } from "@/components/shared/typography/heading";
import Layout from "@/layouts/layout.astro";
import { loadGlobalData } from "@/lib/sanity";

const globalData = await loadGlobalData();
---

<Layout title="Shop all" globalData={globalData}>
  <section
    class="mx-auto flex max-w-max-screen flex-col gap-10 px-m pt-26 pb-10 lg:px-xl"
  >
    <Heading desktopSize="7xl" font="serif" mobileSize="2xl" tag="h1">
      Shop all products
    </Heading>
    <ProductsGrid />
  </section>
</Layout>

<script>
  let scrollPositions = new Map();

  document.addEventListener("astro:before-preparation", (e) => {
    scrollPositions.set(e.from.pathname, window.scrollY);
  });

  document.addEventListener("astro:after-swap", () => {
    const saved = scrollPositions.get(window.location.pathname);
    if (saved !== undefined) {
      window.scrollTo(0, saved);
    }
  });
</script>
