---
import WebsiteLayout from "@/layouts/WebsiteLayout.astro";
import { getClient } from "@/lib/sanity";
import { FAQS_PAGE_QUERY, GLOBAL_QUERY } from "@packages/sanity/queries";
import type { FAQS_PAGE_QUERYResult } from "@packages/sanity/types";
import FaqPage from "@/components/faqs/FaqPage";

export const prerender = true;

const sanityClient = getClient();

const [faqsData, globalData] = await Promise.all([
  sanityClient.fetch<FAQS_PAGE_QUERYResult>(FAQS_PAGE_QUERY),
  sanityClient.fetch(GLOBAL_QUERY),
]);

if (!faqsData) {
  return Astro.redirect("/404");
}
---

<WebsiteLayout
  title={faqsData?.title || "FAQs"}
  description={faqsData?.description || "Frequently asked questions"}
  header={globalData?.header}
  footer={globalData?.footer}
>
  <FaqPage client:load data={faqsData} />
</WebsiteLayout>
