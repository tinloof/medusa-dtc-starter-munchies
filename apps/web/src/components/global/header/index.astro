---
import type { Header as HeaderType } from "@packages/sanity/types";
import RichText from "@/components/shared/rich-text.astro";
import { Body } from "@/components/shared/typography/body";
import { listCountries } from "@/lib/medusa/regions";
import { HeaderClient } from "./header-client";
import { AnnouncementBar } from "./parts/announcement-bar";
import { BottomBorder } from "./parts/bottom-border";

type Props = HeaderType;

const header = Astro.props;

const countries = await listCountries();
---

<header
  class="sticky top-0 z-50 flex w-full flex-col items-center bg-background"
>
  <AnnouncementBar client:load transition:persist="announcement-bar">
    {header.showAnnouncement && header.announcementText && (
      <Body desktopSize="sm" font="sans" mobileSize="xs">
        <RichText value={header.announcementText} />
      </Body>
    )}
  </AnnouncementBar>
  <HeaderClient
    client:load
    transition:persist="navigation"
    header={header}
    countries={countries}
  />

  <div class="relative z-30 w-screen" id="navigation-portal" />

  <BottomBorder client:load className="lg:hidden" />
</header>
